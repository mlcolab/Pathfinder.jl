<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Pathfinder.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://sethaxen.github.io/Pathfinder.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Pathfinder.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Single-path-Pathfinder"><span>Single-path Pathfinder</span></a></li><li><a class="tocitem" href="#Multi-path-Pathfinder"><span>Multi-path Pathfinder</span></a></li><li><a class="tocitem" href="#Uses"><span>Uses</span></a></li><li><a class="tocitem" href="#Integration-with-the-Julia-ecosystem"><span>Integration with the Julia ecosystem</span></a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="lib/public/">Public</a></li><li><a class="tocitem" href="lib/internals/">Internals</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="examples/quickstart/">Quickstart</a></li><li><a class="tocitem" href="examples/initializing-hmc/">Initializing HMC</a></li><li><a class="tocitem" href="examples/turing/">Turing usage</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sethaxen/Pathfinder.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Pathfinder.jl:-Parallel-quasi-Newton-variational-inference"><a class="docs-heading-anchor" href="#Pathfinder.jl:-Parallel-quasi-Newton-variational-inference">Pathfinder.jl: Parallel quasi-Newton variational inference</a><a id="Pathfinder.jl:-Parallel-quasi-Newton-variational-inference-1"></a><a class="docs-heading-anchor-permalink" href="#Pathfinder.jl:-Parallel-quasi-Newton-variational-inference" title="Permalink"></a></h1><p>This package implements Pathfinder, <sup class="footnote-reference"><a id="citeref-Zhang2021" href="#footnote-Zhang2021">[Zhang2021]</a></sup> a variational method for initializing Markov chain Monte Carlo (MCMC) methods.</p><h2 id="Single-path-Pathfinder"><a class="docs-heading-anchor" href="#Single-path-Pathfinder">Single-path Pathfinder</a><a id="Single-path-Pathfinder-1"></a><a class="docs-heading-anchor-permalink" href="#Single-path-Pathfinder" title="Permalink"></a></h2><p>Single-path Pathfinder (<a href="lib/public/#Pathfinder.pathfinder"><code>pathfinder</code></a>) attempts to return draws in or near the typical set, usually with many fewer gradient evaluations. Pathfinder uses the <a href="https://en.wikipedia.org/wiki/Limited-memory_BFGS">limited-memory BFGS</a>(L-BFGS) optimizer to construct a <em>maximum a posteriori</em> (MAP) estimate of a target posterior distribution <span>$p$</span>. It then uses the trace of the optimization to construct a sequence of multivariate normal approximations to the target distribution, returning the approximation that maximizes the <a href="https://en.wikipedia.org/wiki/Evidence_lower_bound">evidence lower bound</a> (ELBO) – equivalently, minimizes the <a href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Kullback-Leibler</a> divergence from the target distribution – as well as draws from the distribution.</p><h2 id="Multi-path-Pathfinder"><a class="docs-heading-anchor" href="#Multi-path-Pathfinder">Multi-path Pathfinder</a><a id="Multi-path-Pathfinder-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-path-Pathfinder" title="Permalink"></a></h2><p>Multi-path Pathfinder (<a href="lib/public/#Pathfinder.multipathfinder"><code>multipathfinder</code></a>) consists of running Pathfinder multiple times. It returns a uniformly-weighted mixture model of the multivariate normal approximations of the individual runs. It also uses importance resampling to return samples that better approximate the target distribution and assess the quality of the approximation.</p><h2 id="Uses"><a class="docs-heading-anchor" href="#Uses">Uses</a><a id="Uses-1"></a><a class="docs-heading-anchor-permalink" href="#Uses" title="Permalink"></a></h2><h3 id="Using-the-Pathfinder-draws"><a class="docs-heading-anchor" href="#Using-the-Pathfinder-draws">Using the Pathfinder draws</a><a id="Using-the-Pathfinder-draws-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-Pathfinder-draws" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">Folk theorem of statistical computing</header><div class="admonition-body"><p>When you have computational problems, often there’s a problem with your model.</p></div></div><p>Visualizing posterior draws is a common way to diagnose problems with a model.  However, problematic models often tend to be slow to warm-up. Even if the draws returned by Pathfinder are only approximations to the posterior, they can sometimes still be used to diagnose basic issues such as highly correlated parameters, parameters with very different posterior variances, and multimodality.</p><h3 id="Initializing-MCMC"><a class="docs-heading-anchor" href="#Initializing-MCMC">Initializing MCMC</a><a id="Initializing-MCMC-1"></a><a class="docs-heading-anchor-permalink" href="#Initializing-MCMC" title="Permalink"></a></h3><p>Pathfinder can be used to initialize MCMC. This especially useful when sampling with Hamiltonian Monte Carlo. See <a href="examples/initializing-hmc/#Initializing-HMC-with-Pathfinder">Initializing HMC with Pathfinder</a> for details.</p><h2 id="Integration-with-the-Julia-ecosystem"><a class="docs-heading-anchor" href="#Integration-with-the-Julia-ecosystem">Integration with the Julia ecosystem</a><a id="Integration-with-the-Julia-ecosystem-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-the-Julia-ecosystem" title="Permalink"></a></h2><p>Pathfinder uses several packages for extended functionality:</p><ul><li><a href="https://optimization.sciml.ai/stable/">Optimization.jl</a>: This allows the L-BFGS optimizer to be replaced with any of the many Optimization-compatible optimizers and supports use of callbacks. Note that any changes made to Pathfinder using these features would be experimental.</li><li><a href="https://juliafolds.github.io/Transducers.jl/stable/">Transducers.jl</a>: parallelization support</li><li><a href="https://juliastats.org/Distributions.jl/stable/">Distributions.jl</a>/<a href="https://github.com/JuliaStats/PDMats.jl">PDMats.jl</a>: fits can be used anywhere a <code>Distribution</code> can be used</li><li><a href="https://github.com/JuliaDiff/AbstractDifferentiation.jl">AbstractDifferentiation.jl</a>: selecting the AD package used to differentiate the provided log-density function.</li><li><a href="https://julialogging.github.io/ProgressLogging.jl/stable/">ProgressLogging.jl</a>: In Pluto, Juno, and VSCode, nested progress bars are shown. In the REPL, use TerminalLoggers.jl to get progress bars.</li></ul><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Zhang2021"><a class="tag is-link" href="#citeref-Zhang2021">Zhang2021</a>Lu Zhang, Bob Carpenter, Andrew Gelman, Aki Vehtari (2021).           Pathfinder: Parallel quasi-Newton variational inference.           arXiv: <a href="https://arxiv.org/abs/2108.03782">2108.03782</a> [stat.ML].           <a href="https://github.com/LuZhangstat/Pathfinder">Code</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="lib/public/">Public »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.21 on <span class="colophon-date" title="Thursday 14 July 2022 12:13">Thursday 14 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
